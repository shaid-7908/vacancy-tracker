<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="Reset your password securely" />
    <meta name="author" content="Vacancy Tracker" />
    <title>Reset Password | Vacancy Tracker</title>
    <link href="css/styles.css" rel="stylesheet" />
    <link href="css/recover-password-page.css" rel="stylesheet" />

    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
</head>

<body>
    <div class="password-reset-container">
        <div class="reset-card">
            <div class="reset-header">
                <div class="reset-icon">
                    <i class="fas fa-key"></i>
                </div>
                <h1 class="reset-title">Reset Password</h1>
                <p class="reset-subtitle">Secure account recovery</p>
            </div>

            <div class="reset-body">
                <p class="reset-description">
                    Enter your email address and we'll send you a secure link to reset your password.
                    This link will expire in 24 hours for your security.
                </p>

                <div class="success-message" id="successMessage">
                    <i class="fas fa-check-circle"></i>
                    Password reset link has been sent to your email address.
                </div>

                <div class="error-message" id="errorMessage">
                    <i class="fas fa-exclamation-circle"></i>
                    <span id="errorText">An error occurred. Please try again.</span>
                </div>

                <form id="resetForm" method="POST" action="/reset-password">
                    <div class="form-group">
                        <input class="form-control-modern" id="inputEmail" name="email" type="email"
                            placeholder="Enter your email address" required autocomplete="email" />
                        <i class="fas fa-envelope input-icon"></i>
                    </div>

                    <button class="btn-reset" type="submit" id="resetBtn">
                        <span class="loading-spinner"></span>
                        <span class="btn-text">Send Reset Link</span>
                    </button>
                </form>

                <div class="security-note">
                    <i class="fas fa-shield-alt"></i>
                    Your security is our priority. The reset link will be sent to your registered email address only.
                </div>

                <div class="divider">
                    <span>or</span>
                </div>

                <div class="auth-links">
                    <a href="/login" class="auth-link">
                        <i class="fas fa-arrow-left"></i> Back to Login
                    </a>
                    <a href="/register" class="auth-link">
                        <i class="fas fa-user-plus"></i> Create Account
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>
    
<script>
    $(document).ready(function () {
        const $form = $('#resetForm');
        const $btn = $('#resetBtn');
        const $btnText = $btn.find('.btn-text');
        const $successMessage = $('#successMessage');
        const $errorMessage = $('#errorMessage');
        const $errorText = $('#errorText');
        const $emailInput = $('#inputEmail');

        // Form submission handler
        $form.on('submit', function (e) {
            e.preventDefault();

            const email = $emailInput.val().trim();

            if (!email) {
                showError('Please enter your email address.');
                return;
            }

            if (!isValidEmail(email)) {
                showError('Please enter a valid email address.');
                return;
            }

            // Show loading state
            $btn.addClass('loading').prop('disabled', true);
            $btnText.text('Sending...');
            hideMessages();

            // Send AJAX request (replace URL with actual endpoint)
            $.ajax({
                url: '/recover-password', // â† Replace with your API endpoint
                method: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ email }),
                success: function (response) {
                    showSuccess();
                    $form[0].reset();
                },
                error: function (xhr) {
                    const message = xhr.responseJSON?.message || 'Something went wrong.';
                    showError(message);
                },
                complete: function () {
                    $btn.removeClass('loading').prop('disabled', false);
                    $btnText.text('Send Reset Link');
                }
            });
        });

        // Email validation
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        // Show success message
        function showSuccess() {
            $successMessage.show();
            $errorMessage.hide();
            setTimeout(() => $successMessage.fadeOut(), 5000);
        }

        // Show error message
        function showError(message) {
            $errorText.text(message);
            $errorMessage.show();
            $successMessage.hide();
            setTimeout(() => $errorMessage.fadeOut(), 5000);
        }

        // Hide all messages
        function hideMessages() {
            $successMessage.hide();
            $errorMessage.hide();
        }

        // Input focus effects
        $emailInput.on('focus', function () {
            $(this).parent().addClass('focused');
        });

        $emailInput.on('blur', function () {
            $(this).parent().removeClass('focused');
        });

        // Real-time email validation
        $emailInput.on('input', function () {
            const email = $(this).val().trim();
            $(this).css('border-color', email && !isValidEmail(email) ? '#dc3545' : '#e1e5e9');
        });
    });
</script>

</body>

</html>